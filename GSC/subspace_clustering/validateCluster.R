datadir="/home/obig/Projects/sub_space_clustering/KiWi/GSE2109_1026exps_16Aug2006/k100000_w18_subs1_kplus100000_probe_mappable2uniprot_ENSG_overlap"
setwd(datadir)

expr_data = read.table("GSE2109_1026exps_16Aug2006_gcrma_probe_mappable2uniprot_AND_ENSG_overlap.txt", header=T, quote="", sep="\t", comment.char="", as.is=1, row.names=1)

#cluster_name="29433"
#cluster_exps=c("GSM102443.CEL","GSM102505.CEL","GSM46903.CEL","GSM53109.CEL","GSM53072.CEL","GSM76569.CEL","GSM53088.CEL","GSM53056.CEL","GSM53089.CEL","GSM53057.CEL")
#cluster_genes=c("200934_at","201546_at","209004_s_at","212168_at","213024_at")

#cluster_name="14717"
#cluster_exps=c("GSM102443.CEL","GSM102505.CEL","GSM46903.CEL","GSM89104.CEL","GSM76569.CEL","GSM53056.CEL","GSM53109.CEL","GSM53172.CEL","GSM53159.CEL","GSM53143.CEL","GSM76587.CEL","GSM76617.CEL","GSM89032.CEL","GSM38063.CEL","GSM89005.CEL","GSM38061.CEL","GSM102537.CEL","GSM89020.CEL","GSM117645.CEL","GSM53118.CEL","GSM46953.CEL","GSM46842.CEL","GSM89012.CEL","GSM53148.CEL","GSM53169.CEL","GSM53175.CEL","GSM76581.CEL","GSM38109.CEL","GSM76596.CEL","GSM102475.CEL")
#cluster_genes=c("205711_x_at","208870_x_at","213366_x_at","217926_at")

#cluster_name="13290"
#cluster_exps=c("GSM102505.CEL","GSM88958.CEL","GSM102443.CEL","GSM46903.CEL","GSM117587.CEL","GSM53109.CEL","GSM76620.CEL","GSM53147.CEL","GSM89002.CEL","GSM53034.CEL","GSM89088.CEL","GSM53161.CEL","GSM46872.CEL","GSM117772.CEL","GSM89080.CEL","GSM102455.CEL","GSM102544.CEL","GSM102532.CEL","GSM102512.CEL","GSM89094.CEL","GSM53092.CEL","GSM89077.CEL","GSM117716.CEL","GSM89018.CEL","GSM76564.CEL","GSM89019.CEL","GSM38080.CEL","GSM102526.CEL","GSM117710.CEL","GSM46859.CEL","GSM88947.CEL","GSM89071.CEL","GSM102582.CEL","GSM88984.CEL","GSM89005.CEL","GSM38090.CEL","GSM89065.CEL","GSM76507.CEL","GSM88959.CEL","GSM38052.CEL","GSM46863.CEL","GSM38063.CEL","GSM53115.CEL","GSM89056.CEL","GSM53175.CEL","GSM76587.CEL","GSM53085.CEL","GSM76529.CEL","GSM76645.CEL","GSM53184.CEL","GSM76520.CEL","GSM53058.CEL","GSM53094.CEL","GSM76627.CEL","GSM76641.CEL","GSM53065.CEL","GSM76535.CEL","GSM53130.CEL")
#cluster_genes=c("206989_s_at","215416_s_at")

cluster_name="22177"
cluster_exps=c("GSM46908.CEL","GSM46818.CEL","GSM46853.CEL","GSM46852.CEL","GSM46900.CEL","GSM46854.CEL","GSM53072.CEL","GSM46903.CEL","GSM53096.CEL","GSM76556.CEL","GSM117626.CEL","GSM89005.CEL","GSM38083.CEL","GSM76550.CEL","GSM46973.CEL")
cluster_genes=c("200001_at","208308_s_at","208631_s_at","208675_s_at","208764_s_at","217786_at")

data=expr_data[cluster_genes,cluster_exps]

pdf(file=paste("KiWicluster_",cluster_name,".pdf", sep=""))
matplot(t(data), type="l", xaxt="n", ylab="Expression value (GCRMA)", main=paste("Profile of GSE2109 data for Kiwi cluster ",cluster_name,sep=""))
xlabs=colnames(data)
axis(1,1:length(xlabs),labels=xlabs,cex.axis=0.6,las=2)
legend(x="bottomright",rownames(data),cex=0.5)
dev.off()
